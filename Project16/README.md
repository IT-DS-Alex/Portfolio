# Оптимизация производственных расходов на комбинате

Чтобы оптимизировать производственные расходы, металлургический комбинат ООО «Так закаляем сталь» решил уменьшить потребление электроэнергии на этапе обработки стали. Вам предстоит построить модель, которая предскажет температуру стали.

### Описание этапа обработки

Сталь обрабатывают в металлическом ковше вместимостью около 100 тонн. Чтобы ковш выдерживал высокие температуры, изнутри его облицовывают огнеупорным кирпичом. Расплавленную сталь заливают в ковш и подогревают до нужной температуры графитовыми электродами. Они установлены в крышке ковша. 

Из сплава выводится сера (десульфурация), добавлением примесей корректируется химический состав и отбираются пробы. Сталь легируют — изменяют её состав — подавая куски сплава из бункера для сыпучих материалов или проволоку через специальный трайб-аппарат (англ. tribe, «масса»).

Перед тем как первый раз ввести легирующие добавки, измеряют температуру стали и производят её химический анализ. Потом температуру на несколько минут повышают, добавляют легирующие материалы и продувают сплав инертным газом. Затем его перемешивают и снова проводят измерения. Такой цикл повторяется до достижения целевого химического состава и оптимальной температуры плавки.

Тогда расплавленная сталь отправляется на доводку металла или поступает в машину непрерывной разливки. Оттуда готовый продукт выходит в виде заготовок-слябов (англ. *slab*, «плита»).

### Описание данных

Данные состоят из файлов, полученных из разных источников:

- `data_arc_new.csv` — данные об электродах;
- `data_bulk_new.csv` — данные о подаче сыпучих материалов (объём);
- `data_bulk_time_new.csv` *—* данные о подаче сыпучих материалов (время);
- `data_gas_new.csv` — данные о продувке сплава газом;
- `data_temp_new.csv` — результаты измерения температуры;
- `data_wire_new.csv` — данные о проволочных материалах (объём);
- `data_wire_time_new.csv` — данные о проволочных материалах (время).

# Цель проекта

Необходимо оптимизировать производственные расходы на металлургическом комбинате ООО «Так закаляем сталь» и для этого небходимо построить несколько моделей, которые предскажут температуру стали, выбрать лучшую и проверить ее на тренеровочной выборке.

## План работы:

1.Подготовить данные (типы данных, анамалии, пропуски).

2.Подготовка признаков (составление единой таблицы со всеми данными, выделение целевого признака).

3.Выбор моделей.

4.Оценка лучшей модели на тестовой выборке.

![image](https://github.com/IT-DS-Alex/Portfolio/assets/140064630/0d65190a-ec69-4438-b9e0-1f71e9f668dd)

### Вывод:

1.Имена столбцов превели к английскому языку прописными буквами и убрали пробелы.

2.Перевели данные время в формат datetime.

3.Определили, что после 2500 партии происходит один замер.

4.Добавли дополнительный параметр - количество интераций в партии и сумму мощностей. 

5.Есть некоторые материалы для плавления, которые добавляли очень редко, нужно рассмотреть, как повлияет исключение таких столбцов на модель.

6.В таблицах добавления материалов пропуска можно заполнить значением 0, но сделае это только перед обучение, чтобы посмотреть на реальное распределение материалов.

7.В температуре есть значения сильно ниже плавления стали, убрали значения ниже 1500.

## Рассмотрим следующие модели:

Дерево решений, Случайный лес, LightGBM, XGBoost, CatBoost

![image](https://github.com/IT-DS-Alex/Portfolio/assets/140064630/44c9eb3d-6fd8-4570-8e13-82aa122333f0)


## Вывод:

Из полученных моделей наилучше всего показала себя модель XGBRegressor с параметрами learning_rate: 0.1, max_depth: 4 и коэффициент детерминации равен 71%.

XGBRegressor оптимально работает под наши данные.

### Рассмотрим важность параметров:

| model | MAE_model | r2_score |
|-----------------|-------|-------------|
|DecisionTreeRegressor|	7.284148|	0.529779|
|RandomForestRegressor|	6.367882|0.774073|
|LGBMRegressor|	6.241037|	0.660520|
|CatBoostRegressor|	6.521541|0.506262|
|XGBRegressor|	6.208254|0.705918|

## Вывод:

1.Рассмотрел следующие модели: дерево решений, случайный лес, lightGBM, XGBoost, CatBoost.

2.Из полученных моделей наилучше всего показала себя модель XGBRegressor с параметрами learning_rate: 0.1, max_depth: 4.

3.Провел оценку лучшей модели на тестовой выборке, итоговая метрика 6.24 - модель можно использовать.

4.Заказчику стоит обратить внимание на первое измерение температуры, время нагрева, данные bulk_15 и wire_4, так как они наиболее сильно влияют на конечную температуру.

# Итоговая модель - XGBRegressor с параметрами learning_rate: 0.1, max_depth: 4. 

# Итоговая метрика модели MAE: 6.24.

